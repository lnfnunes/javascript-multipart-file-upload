function BaseObject(e){BaseObject.prototype.init.call(this,e||{})}function Observable(){BaseObject.call(this,{_handlers:[]})}function XHR(e,t){BaseObject.call(this,{_config:{method:e.method||"",url:e.url||"",withCredentials:e.withCredentials||!1,headers:e.headers||[]},_events:{onSuccess:new Observable,onProgress:new Observable,onComplete:new Observable,onError:new Observable,onCancel:new Observable},_xhr:t||new XMLHttpRequest})}function Heap(e){BaseObject.call(this,{_dataStore:[],_compare:e})}function HeapNode(e,t,a){BaseObject.call(this,{_value:t,_index:a,_dataStore:e})}function Queue(){BaseObject.call(this,{_dataStore:[]})}function Stack(){BaseObject.call(this,{_dataStore:[]})}BaseObject.prototype=Object.create(null,{constructor:BaseObject,init:{value:function(e){this.apply(this,e),this.addListeners()},enumerable:!1,configurable:!1,writable:!0},apply:{value:function(e,t){for(var a in t)e[a]=t[a]},enumerable:!1,configurable:!1,writable:!1},addListeners:{value:function(){},enumerable:!1,configurable:!1,writable:!1}}),Observable.prototype=Object.create(BaseObject.prototype,{constructor:Observable,_handlers:{value:void 0,enumerable:!0,configurable:!1,writable:!0},subscribe:{value:function(e){this._handlers.push(e)},enumerable:!1,configurable:!1,writable:!1},publish:{value:function(e,t){this._handlers.forEach(function(a){a.call(e,t)})},enumerable:!1,configurable:!1,writable:!1},unsubscribe:{value:function(e){this._handlers=this._handlers.filter(function(t){if(t!==e)return t})},enumerable:!1,configurable:!1,writable:!1}}),XHR.prototype=Object.create(BaseObject.prototype,{constructor:XHR,_config:{value:void 0,enumerable:!1,configurable:!0,writable:!0},_events:{value:void 0,enumerable:!1,configurable:!0,writable:!0},_xhr:{value:void 0,enumerable:!1,configurable:!0,writable:!0},_isRequestSuccessful:{value:function(){return 0==this.xhr.status||this.xhr.status>=200&&this.xhr.status<300||304==this.xhr.status||1223==this.xhr.status},enumerable:!1,configurable:!1,writable:!1},_parseHeaders:{value:function(e){var t={};return e?(e.split("\n").forEach(function(e){var a=e.split(":"),r=a[0].trim().toLowerCase(),n=a[1].trim().replace(/"/g,"");r&&(t[r]=t[r]?t[r]+", "+n:n)}),t):t},enumerable:!1,configurable:!1,writable:!1},_onSuccess:{value:function(e,t,a,r){this.events.onSuccess.publish(e,{response:t,status:a,headers:r})},enumerable:!1,configurable:!1,writable:!1},_onProgress:{value:function(e,t){this.events.onProgress.publish(e,t)},enumerable:!1,configurable:!1,writable:!1},_onComplete:{value:function(e,t,a,r){this.events.onComplete.publish(e,{response:t,status:a,headers:r})},enumerable:!1,configurable:!1,writable:!1},_onError:{value:function(e,t,a,r){this.events.onError.publish(e,{response:t,status:a,headers:r})},enumerable:!1,configurable:!1,writable:!1},_onCancel:{value:function(e,t,a,r){this.events.onCancel.publish(e,{response:t,status:a,headers:r})},enumerable:!1,configurable:!1,writable:!1},config:{get:function(){return this._config},configurable:!1},events:{get:function(){return this._events},configurable:!1},xhr:{get:function(){return this._xhr},configurable:!1},addListeners:{value:function(){var e=this;e.xhr.onprogress=function(t){var a=Math.round(t.lengthComputable?100*t.loaded/t.total:0);e._onProgress(e,a)},e.xhr.onload=function(){if(this.readyState===this.DONE){var t=JSON.parse(this.responseText),a=e._parseHeaders(this.getAllResponseHeaders()),r=e._isRequestSuccessful()?"_onSuccess":"_onError";e[r](e,t,this.status,a),e._onComplete(e,t,this.status,a)}},e.xhr.onerror=function(){var t=JSON.parse(this.responseText),a=e._parseHeaders(this.getAllResponseHeaders());e._onError(e,t,this.status,a),e._onComplete(e,t,this.status,a)},e.xhr.onabort=function(){var t=JSON.parse(this.responseText),a=e._parseHeaders(this.getAllResponseHeaders());e._onCancel(e,t,this.status,a),e._onComplete(e,t,this.status,a)}},enumerable:!1,configurable:!1,writable:!1},send:{value:function(e){var t=this;t.xhr.open(t.config.method,t.config.url,!0),t.xhr.withCredentials=t.config.withCredentials,t.config.headers.forEach(function(e){t.xhr.setRequestHeader(e.name,e.value)}),t.xhr.send(e)},enumerable:!1,configurable:!1,writable:!1}}),Heap.prototype=Object.create(BaseObject.prototype,{constructor:Heap,_dataStore:{value:void 0,enumerable:!0,configurable:!1,writable:!0},_compare:{value:void 0,enumerable:!1,configurable:!0,writable:!0},_swap:{value:function(e,t){var a=e.value;e.value=t.value,t.value=a},enumerable:!1,configurable:!1,writable:!1},_heapifyUp:{value:function(e){var t=this._dataStore[e];t.hasParent&&this._compare(t.parent.value,t.value)>0&&(this._swap(t.parent,t),this._heapifyUp(t.parent.index))},enumerable:!1,configurable:!1,writable:!1},_heapifyDown:{value:function(e){var t=this._dataStore[e],a=t;t.hasLeft&&this._compare(a.value,t.left.value)>0&&(a=t.left),t.hasRight&&this._compare(a.value,t.right.value)>0&&(a=t.right),t!=a&&(this._swap(t,a),this._heapifyDown(a.index))},enumerable:!1,configurable:!1,writable:!1},peek:{value:function(){return 0==this._dataStore.length?null:this._dataStore[0].value},enumerable:!1,configurable:!1,writable:!1},poll:{value:function(){var e=this._dataStore[0].Value;return this._swap(this._dataStore[0],this._dataStore[this._dataStore.length-1]),this._dataStore.pop(),this._dataStore.length>0&&this._heapifyDown(0),e},enumerable:!1,configurable:!1,writable:!1},add:{value:function(e){var t=this._dataStore.length;this._dataStore.push(new HeapNode(this._dataStore,e,t)),this._heapifyUp(t)},enumerable:!1,configurable:!1,writable:!1},length:{get:function(){return this._dataStore.length},configurable:!1},empty:{get:function(){return 0==this._dataStore.length},configurable:!1},clear:{value:function(){this._dataStore=[]},configurable:!1}}),HeapNode.prototype=Object.create(BaseObject.prototype,{constructor:HeapNode,_dataStore:{value:void 0,enumerable:!0,configurable:!1,writable:!0},_value:{value:void 0,enumerable:!1,configurable:!1,writable:!0},_index:{value:void 0,enumerable:!1,configurable:!1,writable:!0},index:{get:function(){return this._index},configurable:!1},parent:{get:function(){return this._dataStore[(this._index-1)/2>>0]},configurable:!1},left:{get:function(){return this._dataStore[2*this._index+1]},configurable:!1},right:{get:function(){return this._dataStore[2*this._index+2]},configurable:!1},hasParent:{get:function(){return 0!=this._index&&void 0!=this.parent},configurable:!1},hasLeft:{get:function(){return void 0!=this.left},configurable:!1},hasRight:{get:function(){return void 0!=this.right},configurable:!1},value:{get:function(){return this._value},set:function(e){this._value=e},configurable:!1}}),Queue.prototype=Object.create(BaseObject.prototype,{constructor:Queue,_dataStore:{value:void 0,enumerable:!0,configurable:!1,writable:!0},enqueue:{value:function(e){this._dataStore.push(e)},configurable:!1},dequeue:{value:function(){return this._dataStore.shift()},configurable:!1},front:{value:function(){return this._dataStore[0]},configurable:!1},back:{value:function(){return this._dataStore[this._dataStore.length-1]},configurable:!1},length:{get:function(){return this._dataStore.length},configurable:!1},empty:{get:function(){return 0==this._dataStore.length},configurable:!1},clear:{value:function(){this._dataStore=[]},configurable:!1}}),Stack.prototype=Object.create(BaseObject.prototype,{constructor:Stack,_dataStore:{value:void 0,enumerable:!0,configurable:!1,writable:!0},push:{value:function(e){this._dataStore.push(e)},configurable:!1},pop:{value:function(){return this._dataStore.pop()},configurable:!1},peek:{value:function(){return this._dataStore[this._dataStore.length-1]},configurable:!1},length:{get:function(){return this._dataStore.length},configurable:!1},empty:{get:function(){return 0==this._dataStore.length},configurable:!1},clear:{value:function(){this._dataStore=[]},configurable:!1}});